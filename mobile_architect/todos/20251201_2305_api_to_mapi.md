I tried to login the mobile application angular app: 
http://localhost:4200/login:
this page contains a formula 
slug: nrna 
user email:roshyara@gmail.com 
password: 
POST http://localhost:4200/localhost:8000/nrna/api/v1/auth/login
HttpErrorResponse {headers: _HttpHeaders, status: 404, statusText: 'Not Found', url: 'http://localhost:4200/localhost:8000/nrna/api/v1/auth/login', ok: false, ‚Ä¶}
http://localhost:4200/localhost:8000/nrna/api/v1/auth/login: 404 Not Found
   that should login backend with mapi : 
http://localhost:4200/localhost:8000/nrna/mapi/v1/auth/login but it is doing from api. 
I see the problem! Your Angular app is calling the **WRONG endpoint** and has a **URL construction error**.

## üîç **PROBLEMS IDENTIFIED:**

1. **‚ùå Wrong URL pattern**: Using `/api/v1/` instead of `/mapi/v1/`
2. **‚ùå URL construction error**: `localhost:4200/localhost:8000/...` (double localhost)
3. **‚ùå 404 error**: Endpoint doesn't exist because Angular is calling desktop API instead of mobile API

## üìã **CLAUDE PROMPT ENGINEERING INSTRUCTIONS:**

```
FIX ANGULAR MOBILE APP AUTHENTICATION - CLAUDE PROMPT

TASK: Fix Angular mobile app to use correct mobile API endpoints

PROBLEM:
Angular is calling WRONG endpoint: http://localhost:4200/localhost:8000/nrna/api/v1/auth/login
Should call: http://localhost:8000/nrna/mapi/v1/auth/login

REQUIRED FIXES:

1. FIX URL CONSTRUCTION in Angular ApiService:
   Current (WRONG): http://localhost:4200/localhost:8000/nrna/api/v1/auth/login
   Should be: http://localhost:8000/nrna/mapi/v1/auth/login

2. FIX API PATTERN from /api/v1/ to /mapi/v1/:
   - Angular Mobile App ‚Üí /mapi/v1/* (mobile API)
   - NOT /api/v1/* (desktop API)

3. FILES TO UPDATE in Angular app:

File 1: apps/mobile/src/environments/environment.ts
   ‚ùå Current (wrong):
     apiUrl: 'http://localhost:8000/{tenant}/api/v1'
   
   ‚úÖ Fix to:
     apiUrl: 'http://localhost:8000/{tenant}/mapi/v1'
     platformApiUrl: 'http://localhost:8000/mapi/v1'  // For platform endpoints

File 2: apps/mobile/src/app/core/services/api.service.ts
   ‚ùå Current issue: Building URLs incorrectly
   
   ‚úÖ Fix ApiService methods:
     private getBaseUrl(): string {
       // Should NOT include localhost:4200 in URL!
       return environment.apiUrl.replace('{tenant}', this.tenantSlug);
     }
     
     login(credentials: any): Observable<any> {
       // Should call: http://localhost:8000/nrna/mapi/v1/auth/login
       const url = `${this.getBaseUrl()}/auth/login`;
       return this.http.post(url, credentials);
     }

File 3: apps/mobile/src/app/presentation/pages/auth/login/login.component.ts
   Ensure it calls correct ApiService method with proper parameters.

4. VERIFICATION STEPS:

   Step 1: Check current Angular configuration:
     cat apps/mobile/src/environments/environment.ts
     cat apps/mobile/src/app/core/services/api.service.ts | head -50

   Step 2: Update configuration:
     - Change /api/v1/ to /mapi/v1/
     - Fix URL construction to NOT include localhost:4200 in API calls

   Step 3: Test with curl first:
     curl -X POST "http://localhost:8000/nrna/mapi/v1/auth/login" \
       -H "Content-Type: application/json" \
       -d '{"email":"roshyara@gmail.com","password":"your_password"}'

   Step 4: Test Angular after fixes.

5. CRITICAL RULES:
   - Angular Mobile ‚Üí /mapi/v1/*
   - Vue Desktop ‚Üí /api/v1/*
   - API calls go to localhost:8000 (Laravel backend)
   - Angular app runs on localhost:4200
   - NEVER mix localhost:4200 with API URLs

6. EXPECTED RESULT:
   Angular should call: POST http://localhost:8000/nrna/mapi/v1/auth/login
   Laravel returns: JSON with Sanctum token
   Angular stores token and proceeds to app.

IMPLEMENTATION ORDER:
1. First check current Angular config
2. Fix environment.ts (apiUrl pattern)
3. Fix ApiService (URL construction)
4. Test with curl
5. Test Angular app
```

## üö® **ADDITIONAL DEBUGGING INSTRUCTIONS:**

```
FIRST, check current Angular configuration:

1. Show environment.ts:
   cat apps/mobile/src/environments/environment.ts

2. Show ApiService URL construction:
   cat apps/mobile/src/app/core/services/api.service.ts | grep -n "getBaseUrl\|http://\|apiUrl"

3. Show login component:
   cat apps/mobile/src/app/presentation/pages/auth/login/login.component.ts | head -50

BASED ON CURRENT CODE, fix:

If environment.ts has:
   apiUrl: 'http://localhost:8000/{tenant}/api/v1'
Change to:
   apiUrl: 'http://localhost:8000/{tenant}/mapi/v1'

If ApiService has incorrect URL construction (adding localhost:4200), fix it.

TEST CURL COMMAND to verify backend works:
   curl -v -X POST "http://localhost:8000/nrna/mapi/v1/auth/login" \
     -H "Content-Type: application/json" \
     -d '{"email":"roshyara@gmail.com","password":"actual_password"}'
```

## üéØ **QUICK FIX TEMPLATE FOR CLAUDE:**

```
ANGULAR API URL FIX TEMPLATE:

File: apps/mobile/src/environments/environment.ts
-----------------------------------------------
export const environment = {
  production: false,
  
  // FIX THIS LINE - change /api/v1/ to /mapi/v1/
  apiUrl: 'http://localhost:8000/{tenant}/mapi/v1',
  
  // Platform mobile API (for tenant discovery)
  platformApiUrl: 'http://localhost:8000/mapi/v1',
  
  // Angular app URL (different from API URL!)
  appUrl: 'http://localhost:4200'
};

File: apps/mobile/src/app/core/services/api.service.ts
------------------------------------------------------
@Injectable({ providedIn: 'root' })
export class ApiService {
  private tenantSlug: string = '';
  
  setTenant(slug: string) {
    this.tenantSlug = slug;
  }
  
  // FIX: Remove any localhost:4200 from API URL construction
  private getBaseUrl(): string {
    if (!this.tenantSlug) {
      throw new Error('Tenant slug not set');
    }
    // Should return: http://localhost:8000/nrna/mapi/v1
    return environment.apiUrl.replace('{tenant}', this.tenantSlug);
  }
  
  login(credentials: any): Observable<any> {
    // Should call: http://localhost:8000/nrna/mapi/v1/auth/login
    const url = `${this.getBaseUrl()}/auth/login`;
    return this.http.post(url, credentials);
  }
}

File: apps/mobile/src/app/presentation/pages/auth/login/login.component.ts
-------------------------------------------------------------------------
login() {
  // Set tenant from form input
  this.apiService.setTenant(this.tenantSlug);
  
  // This should call: http://localhost:8000/nrna/mapi/v1/auth/login
  this.apiService.login({
    email: this.email,
    password: this.password
  }).subscribe(
    response => console.log('Success:', response),
    error => console.error('Error:', error)
  );
}
```

**Give Claude this prompt to fix your Angular app configuration!**