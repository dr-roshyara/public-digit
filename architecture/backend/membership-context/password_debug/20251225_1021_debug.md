The error shows that the `CredentialValidationService` is trying to connect to a **MySQL database** but you're using **PostgreSQL**. The code on line 44 shows:

```php
$pdo = new PDO(
    sprintf(
        'mysql:host=%s;port=%d;dbname=%s',  // ‚ùå WRONG! Should be pgsql
        $credentials->getHost(),
        $credentials->getPort(),
        $credentials->getDatabaseName()
    ),
    // ...
);
```

This is causing a timeout because it's trying to connect to PostgreSQL using MySQL driver.

## **üö® IMMEDIATE FIX**

### **1. Fix the CredentialValidationService**

Update `CredentialValidationService.php` at line 44:

```php
// Change from MySQL to PostgreSQL
$pdo = new PDO(
    sprintf(
        'pgsql:host=%s;port=%d;dbname=%s;',  // ‚úÖ FIXED
        $credentials->getHost(),
        $credentials->getPort(),
        $credentials->getDatabaseName()
    ),
    $credentials->getUsername(),
    $credentials->getPassword(),
    [
        PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
        PDO::ATTR_TIMEOUT => 5,
        PDO::ATTR_PERSISTENT => false,
    ]
);
```

### **2. Complete Fix for CredentialValidationService**

Here's the complete corrected service:

```php
<?php
// app/Contexts/Platform/Application/Services/CredentialValidationService.php

namespace App\Contexts\Platform\Application\Services;

use PDO;
use Illuminate\Support\Facades\Log;

class CredentialValidationService
{
    public function validateCredentials(DatabaseCredentials $credentials): bool
    {
        Log::info('Validating database credentials', [
            'host' => $credentials->getHost(),
            'port' => $credentials->getPort(),
            'database' => $credentials->getDatabaseName(),
            'username_hash' => hash('sha256', $credentials->getUsername()),
        ]);

        try {
            // ‚úÖ FIXED: Use pgsql driver instead of mysql
            $pdo = new PDO(
                sprintf(
                    'pgsql:host=%s;port=%d;dbname=%s;',
                    $credentials->getHost(),
                    $credentials->getPort(),
                    $credentials->getDatabaseName()
                ),
                $credentials->getUsername(),
                $credentials->getPassword(),
                [
                    PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
                    PDO::ATTR_TIMEOUT => 5,
                    PDO::ATTR_PERSISTENT => false,
                    PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,
                ]
            );

            // Test the connection with a simple query
            $statement = $pdo->query('SELECT 1 as connection_test');
            $result = $statement->fetch(PDO::FETCH_ASSOC);

            if ($result && $result['connection_test'] == 1) {
                Log::info('Database credentials validated successfully');
                return true;
            }

            Log::warning('Database connection test failed', ['result' => $result]);
            return false;

        } catch (\PDOException $e) {
            Log::error('Database credential validation failed', [
                'error' => $e->getMessage(),
                'code' => $e->getCode(),
                'host' => $credentials->getHost(),
                'port' => $credentials->getPort(),
                'database' => $credentials->getDatabaseName(),
            ]);

            throw new \RuntimeException(
                sprintf(
                    'Failed to validate database credentials: %s',
                    $e->getMessage()
                ),
                $e->getCode(),
                $e
            );
        } catch (\Exception $e) {
            Log::error('Unexpected error during credential validation', [
                'error' => $e->getMessage(),
                'type' => get_class($e),
            ]);

            throw new \RuntimeException(
                sprintf(
                    'Unexpected error during credential validation: %s',
                    $e->getMessage()
                ),
                $e->getCode(),
                $e
            );
        }
    }
}
```

### **3. Quick Temporary Fix with Tinker**

If you can't edit the file immediately, run this to test:

```bash
cd packages/laravel-backend
php artisan tinker --execute="

// Test the database connection directly
use Illuminate\\Support\\Facades\\DB;

echo '=== Testing PostgreSQL Connection ===' . PHP_EOL;

// Test landlord database
try {
    \$result = DB::select('SELECT version() as version');
    echo '‚úÖ Landlord DB: ' . \$result[0]->version . PHP_EOL;
} catch (\\Exception \$e) {
    echo '‚ùå Landlord DB: ' . \$e->getMessage() . PHP_EOL;
}

// Test tenant_uml database
try {
    \$config = [
        'driver' => 'pgsql',
        'host' => '127.0.0.1',
        'port' => 5432,
        'database' => 'tenant_uml',
        'username' => 'postgres',
        'password' => 'Devkota@1?',
    ];
    
    Config::set('database.connections.test_uml', \$config);
    DB::purge('test_uml');
    
    \$result = DB::connection('test_uml')->select('SELECT 1 as test');
    echo '‚úÖ tenant_uml DB: Connected' . PHP_EOL;
} catch (\\Exception \$e) {
    echo '‚ùå tenant_uml DB: ' . \$e->getMessage() . PHP_EOL;
}

// Test tenant_test1 database
try {
    \$config = [
        'driver' => 'pgsql',
        'host' => '127.0.0.1',
        'port' => 5432,
        'database' => 'tenant_test1',
        'username' => 'postgres',
        'password' => 'Devkota@1?',
    ];
    
    Config::set('database.connections.test_test1', \$config);
    DB::purge('test_test1');
    
    \$result = DB::connection('test_test1')->select('SELECT 1 as test');
    echo '‚úÖ tenant_test1 DB: Connected' . PHP_EOL;
} catch (\\Exception \$e) {
    echo '‚ùå tenant_test1 DB: ' . \$e->getMessage() . PHP_EOL;
}

echo PHP_EOL . '=== Current Configuration ===' . PHP_EOL;
echo 'Default DB Driver: ' . config('database.default') . PHP_EOL;
echo 'DB Connection: ' . config('database.connections.pgsql.driver') . PHP_EOL;
"
```

### **4. Check Your Database Configuration**

Make sure your `.env` file has the correct PostgreSQL configuration:

```env
# PostgreSQL Configuration
DB_CONNECTION=pgsql
DB_HOST=127.0.0.1
DB_PORT=5432
DB_DATABASE=publicdigit
DB_USERNAME=postgres
DB_PASSWORD=Devkota@1?

# Multi-tenancy
TENANT_PLACEHOLDER_DB=placeholder_tenant_db
TENANT_DB_PREFIX=tenant_
```

### **5. Update Database Configuration**

Check your `config/database.php`:

```php
'connections' => [
    'pgsql' => [
        'driver' => 'pgsql',
        'url' => env('DATABASE_URL'),
        'host' => env('DB_HOST', '127.0.0.1'),
        'port' => env('DB_PORT', '5432'),
        'database' => env('DB_DATABASE', 'forge'),
        'username' => env('DB_USERNAME', 'forge'),
        'password' => env('DB_PASSWORD', ''),
        'charset' => 'utf8',
        'prefix' => '',
        'prefix_indexes' => true,
        'search_path' => 'public',
        'sslmode' => 'prefer',
    ],
    
    'tenant' => [
        'driver' => 'pgsql',  // ‚úÖ Make sure this is pgsql
        'host' => env('DB_HOST', '127.0.0.1'),
        'port' => env('DB_PORT', '5432'),
        'database' => env('TENANT_PLACEHOLDER_DB', 'placeholder_tenant_db'),
        'username' => env('DB_USERNAME', 'forge'),
        'password' => env('DB_PASSWORD', ''),
        'charset' => 'utf8',
        'prefix' => '',
        'prefix_indexes' => true,
        'search_path' => 'public',
        'sslmode' => 'prefer',
    ],
],
```

### **6. Debug Command**

Create this debug command to check all connections:

```php
<?php
// packages/laravel-backend/app/Console/Commands/DebugDatabaseConnections.php

namespace App\Console\Commands;

use Illuminate\Console\Command;
use Illuminate\Support\Facades\DB;
use Illuminate\Support\Facades\Config;
use PDO;

class DebugDatabaseConnections extends Command
{
    protected $signature = 'debug:database
                           {--test-token= : Test with a setup token}
                           {--test-tenant= : Test specific tenant slug}';
    
    protected $description = 'Debug database connection issues';

    public function handle()
    {
        $this->info('üîß Database Connection Debug');
        $this->newLine();
        
        // Test basic PostgreSQL connection
        $this->testPostgreSQL();
        
        // Test tenant connections
        $this->testTenantConnections();
        
        // Test token if provided
        if ($this->option('test-token')) {
            $this->testTokenConnection($this->option('test-token'));
        }
        
        // Test specific tenant
        if ($this->option('test-tenant')) {
            $this->testSpecificTenant($this->option('test-tenant'));
        }
    }
    
    private function testPostgreSQL(): void
    {
        $this->info('üìä Testing PostgreSQL...');
        
        try {
            // Test via Laravel
            $result = DB::select('SELECT version() as version, current_database() as db');
            $this->line("  ‚úÖ Laravel Connection: {$result[0]->version}");
            $this->line("  üìÅ Current DB: {$result[0]->db}");
            
            // Test via raw PDO
            $dsn = sprintf(
                'pgsql:host=%s;port=%d;dbname=%s;',
                env('DB_HOST', '127.0.0.1'),
                env('DB_PORT', 5432),
                env('DB_DATABASE', 'postgres')
            );
            
            $pdo = new PDO(
                $dsn,
                env('DB_USERNAME', 'postgres'),
                env('DB_PASSWORD', ''),
                [
                    PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
                    PDO::ATTR_TIMEOUT => 3,
                ]
            );
            
            $this->line("  ‚úÖ Raw PDO Connection: Success");
            
        } catch (\Exception $e) {
            $this->error("  ‚ùå PostgreSQL Error: {$e->getMessage()}");
        }
        
        $this->newLine();
    }
    
    private function testTenantConnections(): void
    {
        $this->info('üè¢ Testing Tenant Databases...');
        
        $tenants = DB::table('tenants')->get();
        
        foreach ($tenants as $tenant) {
            $this->line("  Testing: {$tenant->slug} ({$tenant->database_name})");
            
            try {
                $config = [
                    'driver' => 'pgsql',
                    'host' => env('DB_HOST', '127.0.0.1'),
                    'port' => env('DB_PORT', 5432),
                    'database' => $tenant->database_name,
                    'username' => env('DB_USERNAME', 'postgres'),
                    'password' => env('DB_PASSWORD', ''),
                ];
                
                Config::set("database.connections.test_{$tenant->slug}", $config);
                DB::purge("test_{$tenant->slug}");
                
                $users = DB::connection("test_{$tenant->slug}")
                    ->table('tenant_users')
                    ->count();
                    
                $this->line("    ‚úÖ Connected ({$users} users)");
                
            } catch (\Exception $e) {
                $this->error("    ‚ùå Failed: {$e->getMessage()}");
            }
        }
        
        $this->newLine();
    }
    
    private function testTokenConnection(string $token): void
    {
        $this->info("üîë Testing Token: {$token}");
        
        try {
            $tokenHash = hash('sha256', $token);
            
            $tokenRecord = DB::table('tenant_setup_tokens')
                ->where('token', $tokenHash)
                ->first();
                
            if (!$tokenRecord) {
                $this->error("  ‚ùå Token not found");
                return;
            }
            
            $this->line("  ‚úÖ Token found for tenant: {$tokenRecord->tenant_id}");
            
            // Get tenant
            $tenant = DB::table('tenants')
                ->where('id', $tokenRecord->tenant_id)
                ->first();
                
            if ($tenant) {
                $this->line("  üë§ Tenant: {$tenant->slug}");
                $this->line("  üóÑÔ∏è  Database: {$tenant->database_name}");
                
                // Try to connect
                $this->testSpecificTenant($tenant->slug);
            }
            
        } catch (\Exception $e) {
            $this->error("  ‚ùå Token test error: {$e->getMessage()}");
        }
    }
    
    private function testSpecificTenant(string $slug): void
    {
        $tenant = DB::table('tenants')->where('slug', $slug)->first();
        
        if (!$tenant) {
            $this->error("  ‚ùå Tenant not found: {$slug}");
            return;
        }
        
        $this->info("  Testing PDO connection to {$tenant->database_name}...");
        
        try {
            // This mimics what CredentialValidationService does
            $dsn = sprintf(
                'pgsql:host=%s;port=%d;dbname=%s;',
                '127.0.0.1',
                5432,
                $tenant->database_name
            );
            
            $start = microtime(true);
            
            $pdo = new PDO(
                $dsn,
                'postgres',
                'Devkota@1?',
                [
                    PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
                    PDO::ATTR_TIMEOUT => 3,
                ]
            );
            
            $time = round((microtime(true) - $start) * 1000, 2);
            $this->line("    ‚úÖ PDO Connection successful ({$time}ms)");
            
            // Test a query
            $stmt = $pdo->query('SELECT COUNT(*) as user_count FROM tenant_users');
            $result = $stmt->fetch(PDO::FETCH_ASSOC);
            $this->line("    üë• Users in database: {$result['user_count']}");
            
        } catch (\PDOException $e) {
            $this->error("    ‚ùå PDO Error: {$e->getMessage()}");
            $this->line("    üí° DSN attempted: pgsql:host=127.0.0.1;port=5432;dbname={$tenant->database_name};");
        } catch (\Exception $e) {
            $this->error("    ‚ùå General Error: {$e->getMessage()}");
        }
    }
}
```

### **7. Run the Debug Command**

```bash
cd packages/laravel-backend
php artisan debug:database --test-token="XpFASXjm6Dh6q8ucfpawV3TnhAo25nZyXvoqjnDCqeDfuvEmV9hu9h7tHBRyhpsu"
```

### **8. Quick Hotfix**

If you need an immediate hotfix without editing the main file, create an override:

```php
<?php
// app/Providers/AppServiceProvider.php

namespace App\Providers;

use Illuminate\Support\ServiceProvider;
use App\Contexts\Platform\Application\Services\CredentialValidationService;

class AppServiceProvider extends ServiceProvider
{
    public function register(): void
    {
        // Override the CredentialValidationService
        $this->app->bind(CredentialValidationService::class, function ($app) {
            return new class extends CredentialValidationService {
                public function validateCredentials($credentials): bool
                {
                    // Your fixed validation logic here
                    try {
                        $pdo = new \PDO(
                            sprintf(
                                'pgsql:host=%s;port=%d;dbname=%s;',
                                $credentials->getHost(),
                                $credentials->getPort(),
                                $credentials->getDatabaseName()
                            ),
                            $credentials->getUsername(),
                            $credentials->getPassword(),
                            [
                                \PDO::ATTR_ERRMODE => \PDO::ERRMODE_EXCEPTION,
                                \PDO::ATTR_TIMEOUT => 5,
                            ]
                        );
                        
                        return (bool) $pdo->query('SELECT 1');
                    } catch (\Exception $e) {
                        \Illuminate\Support\Facades\Log::error('Credential validation failed', [
                            'error' => $e->getMessage()
                        ]);
                        return false;
                    }
                }
            };
        });
    }
}
```

## **üìã SUMMARY**

The error is caused by:
1. **Wrong database driver** in `CredentialValidationService.php` line 44 (`mysql` instead of `pgsql`)
2. **Timeout** because MySQL driver can't connect to PostgreSQL

**Fix steps:**
1. Change `mysql:host=` to `pgsql:host=` in `CredentialValidationService.php`
2. Test with the debug command
3. Make sure your `.env` has correct PostgreSQL credentials

This should resolve the timeout and allow the setup credentials page to work properly.

Perfect! Now I can see the complete picture from the logs. Let me analyze what's happening:

## **üìä ANALYSIS FROM LOGS**

### **‚úÖ GOOD NEWS: Password Reset NOW WORKS!**

From the logs:
```
[2025-12-25 08:39:27] local.INFO: [PASSWORD_SETUP] Admin password set successfully
{"tenant_id":"717d9e43-dcb0-461e-81e3-ea5587400d8e",
"email":"krish.hari.sharma@gmail.com","driver":"pgsql"}
```

**The password reset for the new `nrna` tenant SUCCEEDED!** This means:
1. ‚úÖ Your `SyncMissingTenantDatabaseRecords` command worked
2. ‚úÖ The `tenant_databases` table is now being populated
3. ‚úÖ The password reset service can now find database configurations
4. ‚úÖ The user can now login to the tenant dashboard

### **‚ùå BAD NEWS: View Database Credentials STILL FAILS**

The error is in `CredentialValidationService.php:44` - it's still trying to use MySQL driver instead of PostgreSQL, causing a 30-second timeout.

### **üéØ THE TWO SEPARATE PROBLEMS:**

1. **‚úÖ SOLVED: Password Reset Problem**
   - **Root Cause**: Missing `tenant_databases` table records
   - **Solution**: Your sync command created the missing records
   - **Status**: ‚úÖ **FIXED** (password reset works for `nrna` tenant)

2. **‚ùå STILL BROKEN: View Database Credentials Problem**
   - **Root Cause**: Wrong database driver in `CredentialValidationService.php`
   - **Error**: Using `mysql:` instead of `pgsql:`
   - **Status**: ‚ùå **STILL BROKEN** (30-second timeout)

## **üîß IMMEDIATE FIX FOR CredentialValidationService**

The logs show the exact line causing the timeout. Here's the quick fix:

```php
<?php
// app/Contexts/Platform/Application/Services/CredentialValidationService.php
// Line 44 - CHANGE THIS:

// FROM (wrong - MySQL):
$pdo = new PDO(
    sprintf(
        'mysql:host=%s;port=%d;dbname=%s',  // ‚ùå WRONG
        $credentials->getHost(),
        $credentials->getPort(),
        $credentials->getDatabaseName()
    ),
    $credentials->getUsername(),
    $credentials->getPassword(),
    [
        PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
        PDO::ATTR_TIMEOUT => 5,
    ]
);

// TO (correct - PostgreSQL):
$pdo = new PDO(
    sprintf(
        'pgsql:host=%s;port=%d;dbname=%s;',  // ‚úÖ FIXED
        $credentials->getHost(),
        $credentials->getPort(),
        $credentials->getDatabaseName()
    ),
    $credentials->getUsername(),
    $credentials->getPassword(),
    [
        PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
        PDO::ATTR_TIMEOUT => 3,  // Reduced from 5 to 3 seconds
        PDO::ATTR_PERSISTENT => false,
    ]
);
```

## **üìù COMPLETE FIXED CredentialValidationService**

Here's the complete fixed file:

```php
<?php
// app/Contexts/Platform/Application/Services/CredentialValidationService.php

namespace App\Contexts\Platform\Application\Services;

use PDO;
use Illuminate\Support\Facades\Log;

class CredentialValidationService
{
    public function validateCredentials(DatabaseCredentials $credentials): bool
    {
        Log::info('Validating database credentials', [
            'host' => $credentials->getHost(),
            'port' => $credentials->getPort(),
            'database' => $credentials->getDatabaseName(),
            'username_hash' => hash('sha256', $credentials->getUsername()),
        ]);

        try {
            // ‚úÖ FIXED: Use PostgreSQL driver
            $pdo = new PDO(
                sprintf(
                    'pgsql:host=%s;port=%d;dbname=%s;',
                    $credentials->getHost(),
                    $credentials->getPort(),
                    $credentials->getDatabaseName()
                ),
                $credentials->getUsername(),
                $credentials->getPassword(),
                [
                    PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
                    PDO::ATTR_TIMEOUT => 3,
                    PDO::ATTR_PERSISTENT => false,
                    PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,
                ]
            );

            // Test the connection with a simple query
            $statement = $pdo->query('SELECT 1 as connection_test');
            $result = $statement->fetch(PDO::FETCH_ASSOC);

            if ($result && $result['connection_test'] == 1) {
                Log::info('Database credentials validated successfully');
                return true;
            }

            Log::warning('Database connection test failed', ['result' => $result]);
            return false;

        } catch (\PDOException $e) {
            Log::error('Database credential validation failed', [
                'error' => $e->getMessage(),
                'code' => $e->getCode(),
                'host' => $credentials->getHost(),
                'port' => $credentials->getPort(),
                'database' => $credentials->getDatabaseName(),
                'username' => $credentials->getUsername(), // Added for debugging
            ]);

            // More specific error messages
            if (str_contains($e->getMessage(), 'could not find driver')) {
                throw new \RuntimeException(
                    'PostgreSQL PDO driver not installed. Install with: sudo apt-get install php-pgsql',
                    $e->getCode(),
                    $e
                );
            }

            if (str_contains($e->getMessage(), 'could not connect')) {
                throw new \RuntimeException(
                    sprintf(
                        'Cannot connect to PostgreSQL at %s:%d. Check if PostgreSQL is running and credentials are correct.',
                        $credentials->getHost(),
                        $credentials->getPort()
                    ),
                    $e->getCode(),
                    $e
                );
            }

            throw new \RuntimeException(
                sprintf(
                    'Failed to validate database credentials: %s',
                    $e->getMessage()
                ),
                $e->getCode(),
                $e
            );
        } catch (\Exception $e) {
            Log::error('Unexpected error during credential validation', [
                'error' => $e->getMessage(),
                'type' => get_class($e),
            ]);

            throw new \RuntimeException(
                sprintf(
                    'Unexpected error during credential validation: %s',
                    $e->getMessage()
                ),
                $e->getCode(),
                $e
            );
        }
    }
}
```

## **üöÄ TEST THE FIX**

After fixing the file, test it:

```bash
# Test 1: Check if PostgreSQL PDO driver is installed
cd packages/laravel-backend
php -m | grep pgsql

# Test 2: Try the credentials page again
# Visit: http://localhost:8000/setup/credentials/XpFASXjm6Dh6q8ucfpawV3TnhAo25nZyXvoqjnDCqeDfuvEmV9hu9h7tHBRyhpsu

# Test 3: Check if the user can now login
# Visit: http://nrna.localhost:8000/login
# Email: krish.hari.sharma@gmail.com
# Password: (whatever you set during password reset)
```

## **üìä VERIFICATION FROM LOGS**

From your logs, I can see:

### **Successful Tenant Provisioning:**
```
[2025-12-25 08:38:18] local.INFO: Tenant provisioning started {"slug":"nrna"}
[2025-12-25 08:38:20] local.INFO: PostgreSQL database created {"database":"tenant_nrna"}
[2025-12-25 08:38:22] local.INFO: Admin user created {"email":"krish.hari.sharma@gmail.com"}
[2025-12-25 08:38:23] local.INFO: Tenant provisioning completed successfully
```

### **Successful Password Reset:**
```
[2025-12-25 08:39:27] local.INFO: [PASSWORD_SETUP] Admin password set successfully
```

### **Failed Credential Viewing:**
```
[2025-12-25 08:39:29] local.INFO: [CREDENTIAL_VALIDATION] Starting validation
[2025-12-25 08:40:32] local.ERROR: Maximum execution time of 30 seconds exceeded
```

## **üéØ SUMMARY**

**Status Update:**

1. **‚úÖ Password Reset Problem: FIXED**
   - Your `SyncMissingTenantDatabaseRecords` command worked
   - The `nrna` tenant now has a `tenant_databases` record
   - Password reset works for `krish.hari.sharma@gmail.com`

2. **‚ùå View Credentials Problem: STILL BROKEN** 
   - `CredentialValidationService.php` uses MySQL driver instead of PostgreSQL
   - Causes 30-second timeout
   - Needs one-line fix: change `mysql:` to `pgsql:`

3. **‚úÖ New Tenant Provisioning: WORKING**
   - `nrna` tenant created successfully
   - Database `tenant_nrna` created
   - Admin user created with setup email sent

## **üîç QUICK DIAGNOSTIC SCRIPT**

Run this to verify everything is working:

```bash
cd packages/laravel-backend
php artisan tinker --execute="

use Illuminate\\Support\\Facades\\DB;
use Illuminate\\Support\\Facades\\Log;

echo '=== SYSTEM STATUS CHECK ===' . PHP_EOL . PHP_EOL;

// 1. Check tenant_databases table
echo '1. Checking tenant_databases table...' . PHP_EOL;
\$count = DB::table('tenant_databases')->count();
echo '   Records: ' . \$count . PHP_EOL;

// List tenants
\$tenants = DB::table('tenant_databases')->get();
foreach (\$tenants as \$tenant) {
    echo '   - ' . \$tenant->slug . ': ' . \$tenant->database_name . PHP_EOL;
}

// 2. Check specific tenant (nrna)
echo PHP_EOL . '2. Checking nrna tenant...' . PHP_EOL;
\$nrna = DB::table('tenants')->where('slug', 'nrna')->first();
if (\$nrna) {
    echo '   ‚úÖ Tenant found: ' . \$nrna->database_name . PHP_EOL;
    
    // Check tenant_databases record
    \$nrnaDb = DB::table('tenant_databases')->where('tenant_id', \$nrna->id)->first();
    echo '   ' . (\$nrnaDb ? '‚úÖ Database config found' : '‚ùå No database config') . PHP_EOL;
} else {
    echo '   ‚ùå Tenant not found' . PHP_EOL;
}

// 3. Test PostgreSQL PDO
echo PHP_EOL . '3. Testing PostgreSQL PDO...' . PHP_EOL;
try {
    \$pdo = new PDO(
        'pgsql:host=127.0.0.1;port=5432;dbname=tenant_nrna;',
        'postgres',
        'Devkota@1?',
        [PDO::ATTR_TIMEOUT => 3]
    );
    echo '   ‚úÖ PostgreSQL PDO connection works' . PHP_EOL;
} catch (\\Exception \$e) {
    echo '   ‚ùå PDO Error: ' . \$e->getMessage() . PHP_EOL;
}

// 4. Check if MySQL PDO driver would fail
echo PHP_EOL . '4. Testing MySQL PDO (should fail)...' . PHP_EOL;
try {
    \$pdo = new PDO(
        'mysql:host=127.0.0.1;port=5432;dbname=tenant_nrna',
        'postgres',
        'Devkota@1?',
        [PDO::ATTR_TIMEOUT => 1]
    );
    echo '   ‚ùå MySQL PDO worked (unexpected!)' . PHP_EOL;
} catch (\\Exception \$e) {
    echo '   ‚úÖ MySQL PDO failed as expected: ' . \$e->getMessage() . PHP_EOL;
}

echo PHP_EOL . '=== FIX REQUIRED ===' . PHP_EOL;
echo 'Change CredentialValidationService.php line 44 from:' . PHP_EOL;
echo '  \"mysql:host=%s;port=%d;dbname=%s\"' . PHP_EOL;
echo 'To:' . PHP_EOL;
echo '  \"pgsql:host=%s;port=%d;dbname=%s;\"' . PHP_EOL;
"
```

## **üö® URGENT ACTION**

1. **Fix one line** in `CredentialValidationService.php` (line 44)
2. Change `mysql:` to `pgsql:`
3. Test the credentials page again
4. The user should now be able to view and use their database credentials

**This is a one-line fix** that will resolve the remaining timeout issue!